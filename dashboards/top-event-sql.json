{"meta":{"type":"db","canSave":true,"canEdit":true,"canAdmin":true,"canStar":true,"slug":"top-event-sql","url":"/grafana/d/I5R79Qhiz/top-event-sql","expires":"0001-01-01T00:00:00Z","created":"2018-09-06T17:37:27+08:00","updated":"2018-10-12T18:05:25+08:00","updatedBy":"admin","createdBy":"admin","version":39,"hasAcl":false,"isFolder":false,"folderId":22,"folderTitle":"Ash","folderUrl":"/grafana/dashboards/f/uTLeuwhik/ash","provisioned":false},"dashboard":{"annotations":{"list":[{"builtIn":1,"datasource":"-- Grafana --","enable":true,"hide":true,"iconColor":"rgba(0, 211, 255, 1)","name":"Annotations & Alerts","type":"dashboard"}]},"editable":true,"gnetId":null,"graphTooltip":0,"id":23,"iteration":1539338593373,"links":[],"panels":[{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":null,"fill":0,"gridPos":{"h":6,"w":24,"x":0,"y":0},"id":4,"legend":{"alignAsTable":true,"avg":false,"current":false,"max":true,"min":false,"rightSide":true,"show":true,"sort":"max","sortDesc":true,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"sum(oracle_ash_sample{sql_id!=\"null\"})by(db_name,inst)","format":"time_series","interval":"1m","intervalFactor":1,"legendFormat":"{{db_name}} - {{inst}}","refId":"A"}],"thresholds":[],"timeFrom":null,"timeShift":null,"title":"DB ASH Total","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"columns":[],"datasource":null,"fontSize":"100%","gridPos":{"h":18,"w":24,"x":0,"y":6},"id":2,"links":[],"minSpan":24,"pageSize":null,"repeat":null,"repeatDirection":"h","scroll":false,"showHeader":true,"sort":{"col":8,"desc":true},"styles":[{"alias":"Time","dateFormat":"YYYY-MM-DD HH:mm:ss","pattern":"Time","type":"hidden"},{"alias":"","colorMode":"row","colors":["rgba(50, 172, 45, 0.97)","rgba(237, 129, 40, 0.89)","rgba(245, 54, 54, 0.9)"],"dateFormat":"YYYY-MM-DD HH:mm:ss","decimals":2,"mappingType":1,"pattern":"Value","thresholds":["500","1000"],"type":"number","unit":"short"},{"alias":"","colorMode":null,"colors":["rgba(245, 54, 54, 0.9)","rgba(237, 129, 40, 0.89)","rgba(50, 172, 45, 0.97)"],"dateFormat":"YYYY-MM-DD HH:mm:ss","decimals":2,"link":true,"linkTargetBlank":true,"linkTooltip":"${__cell}","linkUrl":"/grafana/d/r1_mzGHiz/oracle-sql-detail?var-sql_id=${__cell}&var-db_name=${__cell_1}&var-inst=${__cell_3}&var-username=${__cell_6}&var-child=0","mappingType":1,"pattern":"sql_id","thresholds":[],"type":"string","unit":"short"},{"alias":"per sec","colorMode":"row","colors":["rgba(50, 172, 45, 0.97)","rgba(237, 129, 40, 0.89)","rgba(245, 54, 54, 0.9)"],"dateFormat":"YYYY-MM-DD HH:mm:ss","decimals":2,"mappingType":1,"pattern":"Value #B","thresholds":["0.9","1"],"type":"number","unit":"short"},{"alias":"","colorMode":null,"colors":["rgba(245, 54, 54, 0.9)","rgba(237, 129, 40, 0.89)","rgba(50, 172, 45, 0.97)"],"decimals":2,"pattern":"/.*/","thresholds":[],"type":"number","unit":"short"}],"targets":[{"expr":"topk(20,sum(count_over_time(oracle_ash_sample{db_name=~\"$db_name\",sql_id!=\"null\"}[$interval])) by(db_name,inst,username,event,sql_id,opname))","format":"table","instant":true,"intervalFactor":1,"legendFormat":"","refId":"A"},{"expr":"topk(20,sum(count_over_time(oracle_ash_sample{db_name=~\"$db_name\",sql_id!=\"null\"}[$interval])) by(db_name,inst,username,event,sql_id,opname)) / $i","format":"table","instant":true,"intervalFactor":1,"refId":"B"}],"title":"","transform":"table","type":"table"}],"refresh":"1m","schemaVersion":16,"style":"dark","tags":[],"templating":{"list":[{"auto":false,"auto_count":30,"auto_min":"10s","current":{"text":"","value":""},"hide":0,"label":null,"name":"interval","options":[],"query":"2m,3m,5m,10m,15m,20m,30m,1h,2h,3h,4h,5h,6h,12h,1d,7d,14d,30d","refresh":2,"type":"interval"},{"auto":false,"auto_count":30,"auto_min":"10s","current":{"text":"600","value":"600"},"hide":0,"label":null,"name":"i","options":[{"selected":false,"text":"300","value":"300"},{"selected":true,"text":"600","value":"600"}],"query":"300,600","refresh":2,"type":"interval"},{"allValue":null,"current":{"tags":[],"text":"zfjs","value":["zfjs"]},"datasource":"p","hide":0,"includeAll":true,"label":null,"multi":true,"name":"db_name","options":[{"selected":false,"text":"All","value":"$__all"},{"selected":false,"text":"dwdata","value":"dwdata"},{"selected":false,"text":"escrow","value":"escrow"},{"selected":false,"text":"fund","value":"fund"},{"selected":false,"text":"mqlog","value":"mqlog"},{"selected":false,"text":"pmd","value":"pmd"},{"selected":false,"text":"report","value":"report"},{"selected":false,"text":"whmdb","value":"whmdb"},{"selected":true,"text":"zfjs","value":"zfjs"},{"selected":false,"text":"zjtg","value":"zjtg"}],"query":"label_values(oracle_up,db_name)","refresh":0,"regex":"","sort":1,"tagValuesQuery":"","tags":[],"tagsQuery":"","type":"query","useTags":false}]},"time":{"from":"now-1h","to":"now"},"timepicker":{"refresh_intervals":["5s","10s","30s","1m","5m","15m","30m","1h","2h","1d"],"time_options":["5m","15m","1h","6h","12h","24h","2d","7d","30d"]},"timezone":"","title":"Top Event SQL","uid":"I5R79Qhiz","version":39}}